<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="Layout类是界面布局的骨架，这个骨架遵循着一些默认行为规则。 如果不清楚这些默认行为，就会很容易放弃Qt，因为界面程序通常出现一些奇怪的现象，比如在主界面外，多次弹出对话框，界面不显示组件等等。 界面"><meta name=KEYWORDS content="[PyQt PySide2 Python]"><meta name=robots content="index,follow"><meta name=googlebot content="index,follow"><base href=http://52etf.net/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%85%ABlayout%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/><meta property="og:title" content="PyQt开发笔记（八）Layout注意事项 | 我爱ETF"><meta name=twitter:title content="PyQt开发笔记（八）Layout注意事项 | 我爱ETF"><meta itemprop=name content="PyQt开发笔记（八）Layout注意事项 | 我爱ETF"><meta name=application-name content="PyQt开发笔记（八）Layout注意事项 | 我爱ETF"><meta property="og:site_name" content><meta name=description content="Layout类是界面布局的骨架，这个骨架遵循着一些默认行为规则。 如果不清楚这些默认行为，就会很容易放弃Qt，因为界面程序通常出现一些奇怪的现象，比如在主界面外，多次弹出对话框，界面不显示组件等等。 界面"><meta itemprop=description content="Layout类是界面布局的骨架，这个骨架遵循着一些默认行为规则。 如果不清楚这些默认行为，就会很容易放弃Qt，因为界面程序通常出现一些奇怪的现象，比如在主界面外，多次弹出对话框，界面不显示组件等等。 界面"><meta property="og:description" content="Layout类是界面布局的骨架，这个骨架遵循着一些默认行为规则。 如果不清楚这些默认行为，就会很容易放弃Qt，因为界面程序通常出现一些奇怪的现象，比如在主界面外，多次弹出对话框，界面不显示组件等等。 界面"><meta name=twitter:description content="Layout类是界面布局的骨架，这个骨架遵循着一些默认行为规则。 如果不清楚这些默认行为，就会很容易放弃Qt，因为界面程序通常出现一些奇怪的现象，比如在主界面外，多次弹出对话框，界面不显示组件等等。 界面"><meta name=url content="http://52etf.net/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%85%ABlayout%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"><meta name=twitter:url content="http://52etf.net/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%85%ABlayout%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"><meta property="og:url" content="http://52etf.net/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%85%ABlayout%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"><link rel=canonical href=http://52etf.net/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%85%ABlayout%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/ itemprop=url><link id=favicon rel=icon type=image/x-icon href=/img/favicon.ico><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/github-markdown.min.css><link rel=stylesheet href=/css/addon.css><meta name=referrer content="no-referrer"><title>我爱ETF</title></head><body><header id=header><nav class=topnav id=myTopNav><ol><li><a href=/>首页</a></li><li><a href=/dash/>市场仪表盘</a></li><li><a href=/books/>书单</a></li><li><a href=/tags/%E7%B2%BE%E9%80%89%E5%9F%BA%E9%87%91/>精选基金</a></li><li><a href=/tools/>量化工具</a></li><li><a href=/tags/>词云</a></li><li><a href=/blog/>博客</a></li><li><a href=/about/>关于</a></li></ol></nav></header><main id=main><article class=markdown-body><h1>PyQt开发笔记（八）Layout注意事项</h1><span class=article_date>Jul 27, 2020</span><p>Layout类是界面布局的骨架，这个骨架遵循着一些默认行为规则。</p><p>如果不清楚这些默认行为，就会很容易放弃Qt，因为界面程序通常出现一些奇怪的现象，比如在主界面外，多次弹出对话框，界面不显示组件等等。</p><h2 id=界面加载>界面加载</h2><p>可以直接使用Designer生成的ui文件，通过QUiTool中的QUiLoader来直接加载显示界面，继承自QMainWindow类。</p><p>也可以使用Pyside-uic来生成py文件后导入使用。</p><p>这两种方式没有太多差异，需要注意的是ui稳健加载的QMainWindow是不能放置在其他Widget中的，只能是单独窗口。</p><p>网上有对默认行为的改写，可以加载到父Widget中。这样的话便可以设计子组件，很方便的组装。</p><p>参考链接：https://stackoverflow.com/questions/27603350/how-do-i-load-children-from-ui-file-in-pyside</p><h2 id=界面组件的引用>界面组件的引用</h2><p>导入py文件方式下，遵循uic生成的文件格式，通常是再次wrap一下，基类就是designer生成时的组件类型。</p><p>比如designer选择的组件是diaglog，则外层wrapper最好也是QDialog（当然也可以是相似Widget，因为基类都是Widget）。</p><p>而后在wrapper中直接setupUI调用ui文件的生成方法。</p><p>避免直接修改py文件的方式来编程，因为修改后，如果再次修改ui重新生成，则修改的自定义方法等都会丢失覆盖。</p><p>如果是直接使用ui文件，则更加方便，wrapper中加载UI后，可以通过self.ui属性访问所有的widget，或者通过findChildren/findChild方式来搜索Widget</p><p>综上，通常的做法都是不修改ui或者py，重新编写view视图py，在里面定义行为和信号，这样view和ui就有效的分离。</p><h2 id=界面的layout规则>界面的Layout规则</h2><p>所有的Container都有默认的Layout, 例如groupbox, frame等。</p><p>想要显示子widget，父widget必须有layout。</p><p>root window比较特别要有一个centralWidget，所以手工撸码需要自定义很多必要的类，</p><pre><code>widget
setCentralWidget(widget)
layout
widget.setLayout(layout)
layout.addWidget(其他子组件)
</code></pre><p>如果发现某些个子组件widget不能正常显示到界面，又没有报错，那么一定是手工Layout出了问题。</p><p>没有找到从ui文件引用Layout的方法，可以直接在view视图中创建。</p><h2 id=如何解决窗口一闪而过>如何解决窗口一闪而过</h2><p>在加载ui文件时，没有报错，窗口一闪而过后推出。</p><p>仔细检查代码会发现，UI被加载时出现在类的方法内，比如</p><pre><code>def create_win():
    ui = QUiLoader.load(xx)
    ui.show()
</code></pre><p>创建本身是成功的，但因为在子方法内，ui属于namespace的局部变量，方法执行后变量销毁，所有窗口消失。</p><p>正确的做法是，将ui挂到类属性中和类保持同存亡</p><pre><code>def create_win():
    self.ui = QUiLoader.load(xx)
    self.ui.show()
</code></pre><h2 id=总结>总结</h2><p>界面显示和布局并不复杂，但不掌握基本的行为，会让初学者抓狂。</p><p>尤其是上面的第二和第四条，理解了这两条基本上就掌握了Qt的Layout布局方法。</p></article><article id=article_tags><a class=item__tag href=/tags/pyqt>#PyQt</a>
<a class=item__tag href=/tags/pyside2>#PySide2</a>
<a class=item__tag href=/tags/python>#Python</a></article><div style=text-align:center><img src=/img/weixin_banner.png width=40%;></div><article id=article_nav><a href=http://52etf.net/blog/3061214222/>新一篇：标星近 5k 的一个超级开源项目，包含了大厂面经，算法图解，电子书等</a>
<a href=http://52etf.net/blog/3057720602/>老一篇：QT设计器在通过资源浏览器插入图片时不显示问题,QtDesigner</a></article><article class=single><h3>推荐阅读:</h3><ol><li><a href=/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E4%B8%83%E4%B8%8D%E8%A7%84%E5%88%99%E6%8E%A7%E4%BB%B6/>PyQt开发笔记（七）不规则进度条</a></li><li><a href=/blog/2020-06-03-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%85%AD%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%E7%AA%97%E5%8F%A3/>PyQt开发笔记（六）日志打印窗口</a></li><li><a href=/blog/2020-06-02-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E4%BA%94%E7%99%BB%E5%BD%95%E7%AA%97%E5%8F%A3%E7%9A%84%E5%AE%9E%E7%8E%B0-copy/>PyQt开发笔记（五）登录窗口</a></li><li><a href=/blog/2020-06-01-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E4%B8%89%E5%A4%9A%E7%BA%BF%E7%A8%8B/>PyQt开发笔记（三）多线程</a></li><li><a href=/blog/2020-06-01-pyqt%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0%E5%9B%9B%E9%80%9A%E7%94%A8worker/>PyQt开发笔记（四）通用的Worker</a></li></ol></article><script src=//unpkg.com/valine/dist/Valine.min.js></script><div id=vcomments></div><script>new Valine({el:'#vcomments',appId:'oc9Q6EXPyOTsTB1u3TF69zx5-gzGzoHsz',appKey:'K9hd59av2lhDkYwXfBGAHFdB',placeholder:'请您在评论时遵守国家法律法规，谢谢',visitor:false,})</script></main><footer id=footer><ul><li><a href=http://52etf.net>版权&copy;52etf.net</a></li><li><a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh>协议CC BY-SA 4.0</a></li><li><a href=http://www.beian.miit.gov.cn>豫ICP备20016066号</a></li></ul></footer></body></html>